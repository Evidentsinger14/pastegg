{"version":3,"sources":["../../src/js/paste.js"],"names":["swap","current","currentContent","next","nextContent","classList","remove","add","tabsContainer","fileId","dataset","id","tabLinks","document","getElementById","rendered","querySelector","renderedA","firstChild","source","sourceA","renderedContent","sourceContent","addEventListener","getElementsByClassName","getDeletionKeys","keys","localStorage","getItem","JSON","parse","setDeletionKeys","setItem","stringify","dkElem","deletionKey","innerText","pasteId","expires","Date","getTime","dkInput","key","undefined","value","deletionForm","Object","entries","querySelectorAll","forEach","pre","lang"],"mappings":"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","sourcesContent":["(function() {\n  function swap(current, currentContent, next, nextContent) {\n    current.classList.remove('is-active');\n    next.classList.add('is-active');\n\n    currentContent.classList.add('is-not-displayed');\n    nextContent.classList.remove('is-not-displayed');\n  }\n\n  for (const tabsContainer of document.getElementsByClassName('paste-tabs-container')) {\n    const fileId = tabsContainer.dataset.id;\n    const tabLinks = document.getElementById(`${fileId}-tab-links`);\n\n    const rendered = tabLinks.querySelector('.paste-rendered-tab');\n    const renderedA = rendered.firstChild;\n\n    const source = tabLinks.querySelector('.paste-source-tab');\n    const sourceA = source.firstChild;\n\n    const renderedContent = tabsContainer.querySelector('div.paste-rendered-content');\n    const sourceContent = tabsContainer.querySelector('div.paste-source-content');\n\n    renderedA.addEventListener('click', () => swap(source, sourceContent, rendered, renderedContent));\n    sourceA.addEventListener('click', () => swap(rendered, renderedContent, source, sourceContent));\n  }\n\n  function getDeletionKeys() {\n    let keys = localStorage.getItem('deletion_keys');\n\n    if (keys === null) {\n      keys = {};\n    } else {\n      keys = JSON.parse(keys);\n    }\n\n    return keys;\n  }\n\n  function setDeletionKeys(keys) {\n    localStorage.setItem('deletion_keys', JSON.stringify(keys));\n  }\n\n  // check if the page is displaying a deletion key and add it to local storage\n  (function() {\n    const dkElem = document.getElementById('deletion_key');\n\n    if (dkElem === null) {\n      return;\n    }\n\n    const deletionKey = dkElem.innerText;\n\n    const keys = getDeletionKeys();\n\n    const pasteId = dkElem.dataset.pasteId;\n\n    keys[pasteId] = {\n      deletionKey,\n      expires: new Date((new Date).getTime() + 30 * 24 * 60 * 60 * 1000),\n    };\n\n    setDeletionKeys(keys);\n  })();\n\n  // check if we have a deletion key for this paste and insert it\n  (function() {\n    const dkInput = document.getElementById('deletion_key_input');\n\n    if (dkInput === null) {\n      return;\n    }\n\n    const pasteId = dkInput.dataset.pasteId;\n\n    const keys = getDeletionKeys();\n\n    const key = keys[pasteId];\n\n    if (key === undefined) {\n      return;\n    }\n\n    dkInput.value = key.deletionKey;\n\n    // add a listener for form submit to remove key from local storage\n    const deletionForm = document.getElementById('deletion_form');\n\n    if (deletionForm === null) {\n      return;\n    }\n\n    deletionForm.addEventListener('submit', () => {\n      const keys = getDeletionKeys();\n      delete keys[pasteId];\n      setDeletionKeys(keys);\n    });\n  })();\n\n  // expire old deletion keys\n  (function() {\n    const keys = getDeletionKeys();\n\n    for (const key of Object.entries(keys)) {\n      if (new Date >= new Date(key[1].expires)) {\n        delete keys[key[0]];\n      }\n    }\n\n    setDeletionKeys(keys);\n  })();\n\n  document\n    .querySelectorAll('.paste-rendered-content pre[lang]')\n    .forEach(pre => pre.classList.add(`language-${pre.lang}`));\n})();\n"],"file":"paste.js"}