{"version":3,"sources":["../../src/js/password.js"],"names":["checkMatch","pw","verify","value","length","classList","add","remove","document","getElementById","addEventListener","e","target","doHides","strength","reveals","getElementsByName","reveal","pwField","parentElement","previousElementSibling","firstElementChild","type","icon","querySelector","passwordStrength","values","name","push","username","email","password","progress","warning","getAttribute","innerHTML","z","zxcvbn","message","crack_times_display","offline_slow_hashing_1e4_per_second","feedback","color","score","pass"],"mappings":"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","sourcesContent":["/* global zxcvbn:false */\n\n(function() {\n  function checkMatch(pw, verify) {\n    if (pw.value === verify.value && pw.value.length !== 0) {\n      verify.classList.add('is-success');\n    } else {\n      verify.classList.remove('is-success');\n    }\n  }\n\n  (function() {\n    const verify = document.getElementById('password_verify');\n    if (verify === null) {\n      return;\n    }\n    verify.addEventListener('input', e => checkMatch(document.getElementById('password'), e.target));\n  })();\n\n  function doHides(pw, strength) {\n    if (pw.value.length === 0) {\n      strength.classList.add('is-not-displayed');\n    } else {\n      strength.classList.remove('is-not-displayed');\n    }\n  }\n\n  (function() {\n    const reveals = document.getElementsByName('password_reveal');\n    for (const reveal of reveals) {\n      reveal.addEventListener('click', () => {\n        const pwField = reveal.parentElement.previousElementSibling.firstElementChild;\n        pwField.type = pwField.type === 'password' ? 'text' : 'password';\n\n        const icon = reveal.querySelector('i.fas');\n        if (pwField.type === 'password') {\n          icon.classList.remove('fa-eye-slash');\n          icon.classList.add('fa-eye');\n        } else {\n          icon.classList.remove('fa-eye');\n          icon.classList.add('fa-eye-slash');\n        }\n      });\n    }\n  })();\n\n  function passwordStrength(pw) {\n    checkMatch(pw, document.getElementById('password_verify'));\n\n    const values = [];\n    {\n      const name = document.getElementById('name');\n      if (name) {\n        values.push(name.value);\n      }\n      const username = document.getElementById('username');\n      if (username) {\n        values.push(username.value);\n      }\n      const email = document.getElementById('email');\n      if (email) {\n        values.push(email.value);\n      }\n    }\n\n    const password = pw.value;\n    const strength = document.getElementById('strength');\n    const progress = document.getElementById('strength_progress');\n    const warning = document.getElementById('strength_warning');\n\n    if (pw.getAttribute('data-bar') === 'hidden') {\n      doHides(pw, progress);\n    }\n\n    if (password.length === 0) {\n      strength.innerHTML = '';\n      warning.innerHTML = '';\n      progress.classList.add('is-danger');\n      progress.classList.remove('is-warning');\n      progress.classList.remove('is-success');\n      return;\n    }\n\n    const z = zxcvbn(password, values);\n\n    let message = `Time to crack your password: ${z.crack_times_display.offline_slow_hashing_1e4_per_second}`;\n    message += ' <small><span class=\"has-text-grey-light tooltip is-tooltip-multiline is-dotted-underlined\" data-tooltip=\"This is the time it would take an attacker to successfully guess your password. Increase your password complexity until you\\'re comfortable with the amount of time.\">What is this?</span></small>';\n    strength.innerHTML = message;\n\n    warning.innerHTML = `<br/>${z.feedback.warning}`;\n\n    let color;\n    switch (z.score) {\n      case 0:\n        color = 'is-danger';\n        break;\n      case 1:\n        color = 'is-danger';\n        break;\n      case 2:\n        color = 'is-warning';\n        break;\n      case 3:\n        color = 'is-warning';\n        break;\n      case 4:\n        color = 'is-success';\n        break;\n    }\n\n    progress.classList.remove('is-danger');\n    progress.classList.remove('is-warning');\n    progress.classList.remove('is-success');\n    progress.classList.add(color);\n  }\n\n  (function() {\n    const pass = document.getElementById('password');\n    if (pass !== null) {\n      pass.addEventListener('input', e => passwordStrength(e.target));\n    }\n  })();\n})();\n"],"file":"password.js"}