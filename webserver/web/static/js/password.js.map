{"version":3,"sources":["../../src/js/password.js"],"names":["checkMatch","pw","verify","value","length","classList","add","remove","document","getElementById","addEventListener","e","target","doHides","strength","reveals","getElementsByName","reveal","pwField","parentElement","previousElementSibling","firstElementChild","type","icon","querySelector","passwordStrength","values","name","push","username","email","password","progress","warning","getAttribute","innerHTML","z","zxcvbn","message","crack_times_display","offline_slow_hashing_1e4_per_second","feedback","color","score"],"mappings":"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","file":"password.js","sourcesContent":["/* global zxcvbn */\n\n(function() {\n  function checkMatch(pw, verify) {\n    if (pw.value === verify.value && pw.value.length !== 0) {\n      verify.classList.add('is-success');\n    } else {\n      verify.classList.remove('is-success');\n    }\n  }\n\n  document\n    .getElementById('password_verify')\n    .addEventListener('input', e => checkMatch(document.getElementById('password'), e.target));\n\n  function doHides(pw, strength) {\n    if (pw.value.length === 0) {\n      strength.classList.add('is-not-displayed');\n    } else {\n      strength.classList.remove('is-not-displayed');\n    }\n  }\n\n  (function() {\n    const reveals = document.getElementsByName('password_reveal');\n    for (const reveal of reveals) {\n      reveal.addEventListener('click', () => {\n        const pwField = reveal.parentElement.previousElementSibling.firstElementChild;\n        pwField.type = pwField.type === 'password' ? 'text' : 'password';\n\n        const icon = reveal.querySelector('i.fas');\n        if (pwField.type === 'password') {\n          icon.classList.remove('fa-eye-slash');\n          icon.classList.add('fa-eye');\n        } else {\n          icon.classList.remove('fa-eye');\n          icon.classList.add('fa-eye-slash');\n        }\n      });\n    }\n  })();\n\n  function passwordStrength(pw) {\n    checkMatch(pw, document.getElementById('password_verify'));\n\n    const values = [];\n    {\n      const name = document.getElementById('name');\n      if (name) {\n        values.push(name.value);\n      }\n      const username = document.getElementById('username');\n      if (username) {\n        values.push(username.value);\n      }\n      const email = document.getElementById('email');\n      if (email) {\n        values.push(email.value);\n      }\n    }\n\n    const password = pw.value;\n    const strength = document.getElementById('strength');\n    const progress = document.getElementById('strength_progress');\n    const warning = document.getElementById('strength_warning');\n\n    if (pw.getAttribute('data-bar') === 'hidden') {\n      doHides(pw, progress);\n    }\n\n    if (password.length === 0) {\n      strength.innerHTML = '';\n      warning.innerHTML = '';\n      progress.classList.add('is-danger');\n      progress.classList.remove('is-warning');\n      progress.classList.remove('is-success');\n      return;\n    }\n\n    const z = zxcvbn(password, values);\n\n    let message = `Time to crack your password: ${z.crack_times_display.offline_slow_hashing_1e4_per_second}`;\n    message += ' <small><span class=\"has-text-grey-light tooltip is-tooltip-multiline is-dotted-underlined\" data-tooltip=\"This is the time it would take an attacker to successfully guess your password. Increase your password complexity until you\\'re comfortable with the amount of time.\">What is this?</i></small>';\n    strength.innerHTML = message;\n\n    warning.innerHTML = `<br/>${z.feedback.warning}`;\n\n    let color;\n    switch (z.score) {\n      case 0:\n        color = 'is-danger';\n        break;\n      case 1:\n        color = 'is-danger';\n        break;\n      case 2:\n        color = 'is-warning';\n        break;\n      case 3:\n        color = 'is-warning';\n        break;\n      case 4:\n        color = 'is-success';\n        break;\n    }\n\n    progress.classList.remove('is-danger');\n    progress.classList.remove('is-warning');\n    progress.classList.remove('is-success');\n    progress.classList.add(color);\n  }\n\n  document.getElementById('password').addEventListener('input', e => passwordStrength(e.target));\n})();\n"]}